{% extends "layout/basic_plan.html" %}
{#{% import os %}#}

{% block content %}


    <div class="row mt-lg-5">
        <div class="col-md-4" style=" background: #e3f2fd;">
            <div class="">

                <label for="exampleFormControlSelect2">Розділи:</label>
                <select class="form-control small" id="exampleFormControlSelect2" size="15" name="rozdili"
                        style="overflow-x:auto;">
                    {% for rubric in rubrics %}
                        {% if rubric.riven == 1 %}
                            <option id="{{ rubric.id }}" owner="{{ rubric.id_owner_id }}" hidden_child=true>
                                {{ rubric.n_r }}.&nbsp;{{ rubric.name }}
                            </option>
                            {% for rubric2 in rubrics %}
                                {% if rubric2.riven == 2 and rubric2.id_owner_id == rubric.id %}
                                    <option id="{{ rubric2.id }}" owner="{{ rubric2.id_owner_id }}"
                                            hidden_child=true>
                                        &nbsp;&nbsp; {{ rubric.n_r }}.&nbsp;{{ rubric2.n_r }}.&nbsp;{{ rubric2.name }}
                                    </option>

                                    {% for rubric3 in rubrics %}
                                        {% if rubric3.riven == 3 and rubric3.id_owner_id == rubric2.id %}
                                            <option id="{{ rubric3.id }}" owner="{{ rubric3.id_owner_id }}"
                                                    hidden_child=true>
                                                &nbsp;&nbsp; &nbsp;&nbsp; {{ rubric.n_r }}.&nbsp;{{ rubric2.n_r }}.&nbsp;{{ rubric3.n_r }}.&nbsp;{{ rubric3.name }}
                                            </option>
                                        {% endif %}
                                    {% endfor %}
                                {% endif %}
                            {% endfor %}
                        {% endif %}
                    {% endfor %}

                    {#                            {{ rubrics_code|safe }}#}
                    {#                            {% autoescape off  %}#}
                    {#                                {{ rubrics_code }}#}
                    {#                            {% endautoescape %}#}

                </select>
            </div>


            {#                <input id="nnn" type="number" value="1"/>#}
        </div>

        <div id="pl" class="col-md-8 " style="background: #e3f2fd;">

        </div>


    </div>


    <script type="text/javascript">
        var n = 1;
        var rubr_id_max = 57;

        jQuery(document).ready(function () {
                n = 1;
                {#alert("{{ rubr_id_max }}");#}
                {#        jQuery('#titleX').val("{{ rubr_id_max|  }}");#}
            }
        );
    </script>
    <script type="text/javascript">


        var a;


        function isDno(el) {
            dno = true;
            $('option').each(function (i, elem) {
                if ($(elem).attr("owner") == el.attr('id')) {
                    dno = false;
                }
            });
            return dno;
        }


        function tree(el, flag) {
            if (isDno(el))
                return true;
            else {
                el.attr("hidden_child", !flag);
                $('option').each(function (i, elem) {
                    if ($(elem).attr("owner") == el.attr('id')) {
                        $(elem).attr("hidden", !flag);
                        tree($(elem), flag);
                    }
                });
            }
        }

        jQuery('#exampleFormControlSelect2').on('change', function () {
            {#jQuery('#exampleFormControlSelect2').on('click', function () {#}
            n = 1;
            a = jQuery(this).find(":selected").attr('id');
            s = "" + a + "/" + n;
            jQuery('#pl').load(s);
            el = jQuery(this).find(":selected");
            tree(el, (el.attr('hidden_child') == 'true'));

        });
    </script>


{% endblock %}
